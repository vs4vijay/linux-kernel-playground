# Raspberry Pi 4 configuration file
# This file is used by the Raspberry Pi firmware

# GPU memory split
gpu_mem=128

# Enable hardware video codecs
enable_gic=1
arm_freq=1500
over_voltage=2
arm_freq_min=500

# Enable 64-bit kernel
arm_64bit=1

# Kernel command line parameters
# root= specifies the root filesystem device
# rootwait waits for the device to be ready
# console specifies the console device
cmdline=console=ttyAMA0,115200 console=tty1 root=/dev/mmcblk0p2 rootfstype=ext4 rootwait fsck.repair=yes elevator=deadline

# Boot configuration
kernel=kernel8.img
initramfs initramfs-linux.img

# GPU configuration
max_framebuffers=2
hdmi_force_hotplug=1

# Display configuration
hdmi_drive=2
hdmi_force_mode=1
config_hdmi_boost=5

# Audio
dtparam=audio=on

# SPI/I2C
dtparam=spi=on
dtparam=i2c_arm=on

# GPIO
dtparam=audio=on

# Camera
start_x=1
gpu_mem=128

# Disable the rainbow splash screen
disable_splash=1

# Enable hardware random number generator
dtparam=random=on

# Enable VC4 driver for KMS/DRM
dtoverlay=vc4-kms-v3d
dtoverlay=vc4-fkms-v3d

# Camera interfaces
dtoverlay=imx219
dtoverlay=imx477

# Enable DRM VC4 V3D driver
dtoverlay=vc4-kms-v3d,cma-256

# Enable I2C interfaces
dtoverlay=i2c0,pins_0_1
dtoverlay=i2c1,pins_2_3

# Enable SPI interfaces
dtoverlay=spi0-2cs

# Enable hardware watchdog
dtparam=watchdog=on

# Enable USB boot
program_usb_boot_mode=1

# Enable extra USB power
max_usb_current=1

# Enable random number generator
dtparam=random=on

# Enable hardware DRM
dtoverlay=vc4-kms-v3d-pi4

# Enable PCIe Gen2
dtparam=pciex1_gen=2
dtparam=pciex2_gen=2

# Enable ethernet
dtparam=eth=on

# Enable wireless interface
dtparam=wireless=on

# Enable bluetooth
dtparam=bluetooth=on

# Enable various device tree overlays
dtoverlay=disable-wifi
dtoverlay=disable-bt
dtoverlay=pi3-miniuart-bt
dtoverlay=spi0-hw-cs
dtoverlay=uart1
dtoverlay=uart3
dtoverlay=uart4
dtoverlay=uart5

# Enable thermal management
dtoverlay=spi0-hw-cs,cs0_pin=8,cs1_pin=7

# Enable fan control
dtoverlay=gpio-fan,gpiopin=14,temp=80000

# Enable proper shutdown for external storage
dtoverlay=sdhost,cd_pin=4

# Enable all i2c interfaces
dtparam=i2c_vc=on
dtparam=i2c1=on

# Enable ADC
dtparam=adc=on

# Enable PWM
dtoverlay=pwm-2chan,pin=12,func=4,pin2=13,func2=4

# Enable GPIO interrupt
dtoverlay=gpio-irq,gpio_pin=17